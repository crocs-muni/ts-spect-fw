0x8000: _start:        LD        R0,0
0x8004:                CMPI      ,R0,81
0x8008:                BRNZ      8010
0x800c:                JMP       8778
0x8010: next_cmd_1:    CMPI      ,R0,82
0x8014:                BRNZ      801c
0x8018:                JMP       8788
0x801c: next_cmd_2:    CMPI      ,R0,83
0x8020:                BRNZ      8028
0x8024:                JMP       87a8
0x8028: next_cmd_3:    CMPI      ,R0,74
0x802c:                BRNZ      8034
0x8030:                JMP       8668
0x8034: next_cmd_4:    CMPI      ,R0,208
0x8038:                BRNZ      8060
0x803c:                LD        R1,12864
0x8040:                LD        R2,32
0x8044:                OR        R1,R1,R2
0x8048:                ROL8      R1,R1
0x804c:                CALL      85d4
0x8050:                ST        R10,4096
0x8054:                ST        R11,4128
0x8058:                ST        R12,4160
0x805c:                END       
0x8060: next_cmd_5:    CMPI      ,R0,209
0x8064:                BRNZ      808c
0x8068:                LD        R1,12864
0x806c:                LD        R2,32
0x8070:                OR        R1,R1,R2
0x8074:                ROL8      R1,R1
0x8078:                CALL      85fc
0x807c:                ST        R10,4096
0x8080:                ST        R11,4128
0x8084:                ST        R12,4160
0x8088:                END       
0x808c: next_cmd_end:  END       
0x8090: inv_q256:      MULP      R2,R26,R26
0x8094:                MULP      R3,R2,R26
0x8098:                MULP      R4,R3,R3
0x809c:                MULP      R4,R4,R4
0x80a0:                MULP      R5,R4,R3
0x80a4:                MULP      R4,R5,R5
0x80a8:                MULP      R4,R4,R4
0x80ac:                MULP      R4,R4,R4
0x80b0:                MULP      R4,R4,R4
0x80b4:                MULP      R5,R4,R5
0x80b8:                MULP      R4,R5,R5
0x80bc:                MULP      R4,R4,R4
0x80c0:                MOVI      R30,6
0x80c4: inv_q256_loop_8:MULP      R4,R4,R4
0x80c8:                MULP      R4,R4,R4
0x80cc:                MULP      R4,R4,R4
0x80d0:                SUBI      R30,R30,3
0x80d4:                BRNZ      80c4
0x80d8:                MULP      R5,R4,R5
0x80dc:                MULP      R4,R5,R5
0x80e0:                MOVI      R30,15
0x80e4: inv_q256_loop_16:MULP      R4,R4,R4
0x80e8:                MULP      R4,R4,R4
0x80ec:                MULP      R4,R4,R4
0x80f0:                SUBI      R30,R30,3
0x80f4:                BRNZ      80e4
0x80f8:                MULP      R6,R4,R5
0x80fc:                MULP      R4,R6,R6
0x8100:                MOVI      R30,63
0x8104: inv_q256_loop_64:MULP      R4,R4,R4
0x8108:                MULP      R4,R4,R4
0x810c:                MULP      R4,R4,R4
0x8110:                SUBI      R30,R30,3
0x8114:                BRNZ      8104
0x8118:                MULP      R5,R4,R6
0x811c:                MULP      R4,R5,R5
0x8120:                MULP      R4,R4,R4
0x8124:                MOVI      R30,30
0x8128: inv_q256_loop_32:MULP      R4,R4,R4
0x812c:                MULP      R4,R4,R4
0x8130:                MULP      R4,R4,R4
0x8134:                SUBI      R30,R30,3
0x8138:                BRNZ      8128
0x813c:                MULP      R4,R4,R6
0x8140:                LD        R5,12352
0x8144:                MOVI      R30,128
0x8148: inv_q256_loop_lowpart:MULP      R4,R4,R4
0x814c:                MULP      R4,R4,R4
0x8150:                LSL       R5,R5
0x8154:                BRC       8168
0x8158: inv_q256_loop_x0:LSL       R5,R5
0x815c:                BRNC      817c
0x8160: inv_q256_loop_x01:MULP      R4,R4,R26
0x8164:                JMP       817c
0x8168: inv_q256_loop_x1:LSL       R5,R5
0x816c:                BRC       8178
0x8170: inv_q256_loop_x10:MULP      R4,R4,R2
0x8174:                JMP       817c
0x8178: inv_q256_loop_x11:MULP      R4,R4,R3
0x817c: inv_q256_loop_lowpart_back:SUBI      R30,R30,2
0x8180:                BRNZ      8148
0x8184:                MOV       R26,R4
0x8188:                RET       
0x818c: inv_p25519_250:MUL25519  R2,R1,R1
0x8190:                MUL25519  R4,R2,R1
0x8194:                MUL25519  R3,R4,R4
0x8198:                MUL25519  R3,R3,R3
0x819c:                MUL25519  R2,R4,R3
0x81a0:                MUL25519  R3,R2,R2
0x81a4:                MUL25519  R3,R3,R3
0x81a8:                MUL25519  R3,R3,R3
0x81ac:                MUL25519  R3,R3,R3
0x81b0:                MUL25519  R2,R2,R3
0x81b4:                MUL25519  R3,R2,R2
0x81b8:                MOVI      R30,7
0x81bc: inv_p25519_loop_8:MUL25519  R3,R3,R3
0x81c0:                SUBI      R30,R30,1
0x81c4:                BRNZ      81bc
0x81c8:                MUL25519  R5,R2,R3
0x81cc:                MUL25519  R3,R5,R5
0x81d0:                MOVI      R30,15
0x81d4: inv_p25519_loop_16_1:MUL25519  R3,R3,R3
0x81d8:                SUBI      R30,R30,1
0x81dc:                BRNZ      81d4
0x81e0:                MUL25519  R2,R5,R3
0x81e4:                MUL25519  R3,R2,R2
0x81e8:                MOVI      R30,15
0x81ec: inv_p25519_loop_16_2:MUL25519  R3,R3,R3
0x81f0:                SUBI      R30,R30,1
0x81f4:                BRNZ      81ec
0x81f8:                MUL25519  R2,R5,R3
0x81fc:                MUL25519  R2,R2,R2
0x8200:                MUL25519  R2,R2,R2
0x8204:                MUL25519  R5,R2,R4
0x8208:                MUL25519  R3,R5,R5
0x820c:                MOVI      R30,49
0x8210: inv_p25519_loop_50_1:MUL25519  R3,R3,R3
0x8214:                SUBI      R30,R30,1
0x8218:                BRNZ      8210
0x821c:                MUL25519  R2,R5,R3
0x8220:                MUL25519  R3,R2,R2
0x8224:                MOVI      R30,99
0x8228: inv_p25519_loop_100:MUL25519  R3,R3,R3
0x822c:                SUBI      R30,R30,1
0x8230:                BRNZ      8228
0x8234:                MUL25519  R2,R2,R3
0x8238:                MUL25519  R3,R2,R2
0x823c:                MOVI      R30,49
0x8240: inv_p25519_loop_50_2:MUL25519  R3,R3,R3
0x8244:                SUBI      R30,R30,1
0x8248:                BRNZ      8240
0x824c:                MUL25519  R2,R3,R5
0x8250:                RET       
0x8254: inv_p25519:    CALL      818c
0x8258:                MUL25519  R3,R2,R2
0x825c:                MUL25519  R3,R3,R3
0x8260:                MUL25519  R3,R3,R1
0x8264:                MUL25519  R3,R3,R3
0x8268:                MUL25519  R3,R3,R3
0x826c:                MUL25519  R3,R3,R3
0x8270:                MUL25519  R1,R3,R4
0x8274:                RET       
0x8278: point_compress_ed25519:MOV       R1,R9
0x827c:                CALL      8254
0x8280:                MUL25519  R7,R7,R1
0x8284:                MUL25519  R8,R8,R1
0x8288:                MOVI      R1,1
0x828c:                AND       R7,R7,R1
0x8290:                ROL       R8,R8
0x8294:                OR        R8,R8,R7
0x8298:                ROR       R8,R8
0x829c:                RET       
0x82a0: point_decompress_ed25519:MOV       R16,R12
0x82a4:                LSL       R16,R16
0x82a8:                BRC       82b4
0x82ac:                MOVI      R22,0
0x82b0:                JMP       82bc
0x82b4: point_decompress_ed25519_x0_1:MOVI      R22,1
0x82b8:                JMP       82bc
0x82bc: point_decompress_ed25519_sqr:LSR       R16,R16
0x82c0:                MOV       R12,R16
0x82c4:                MUL25519  R16,R16,R16
0x82c8:                MOVI      R1,1
0x82cc:                SUBP      R20,R16,R1
0x82d0:                MUL25519  R16,R16,R6
0x82d4:                ADDP      R21,R16,R1
0x82d8:                MUL25519  R18,R21,R21
0x82dc:                MUL25519  R18,R18,R21
0x82e0:                MUL25519  R19,R18,R20
0x82e4:                MUL25519  R18,R18,R18
0x82e8:                MUL25519  R18,R18,R21
0x82ec:                MUL25519  R1,R18,R20
0x82f0:                MOV       R16,R1
0x82f4:                CALL      818c
0x82f8:                MUL25519  R18,R2,R2
0x82fc:                MUL25519  R18,R18,R18
0x8300:                MUL25519  R18,R18,R16
0x8304:                MUL25519  R18,R18,R19
0x8308:                MUL25519  R16,R18,R18
0x830c:                MUL25519  R16,R16,R21
0x8310:                LD        R1,12672
0x8314:                MUL25519  R17,R18,R1
0x8318:                SUBP      R19,R16,R20
0x831c:                ADDP      R20,R16,R20
0x8320:                MOVI      R1,0
0x8324:                CMPA      ,R19,0
0x8328:                BRNZ      8334
0x832c:                MOV       R0,R18
0x8330:                MOVI      R1,1
0x8334: point_decompress_ed25519_vx2_check2:CMPA      ,R20,0
0x8338:                BRNZ      8344
0x833c:                MOV       R0,R17
0x8340:                MOVI      R1,1
0x8344: point_decompress_ed25519_vx2_check_flag:CMPI      ,R1,0
0x8348:                BRZ       839c
0x834c:                MOVI      R1,0
0x8350:                CMPA      ,R0,0
0x8354:                BRNZ      835c
0x8358:                ORI       R1,R1,1
0x835c: point_decompress_ed25519_check_X0_is_1:CMPI      ,R22,1
0x8360:                BRNZ      8368
0x8364:                ORI       R1,R1,2
0x8368: point_decompress_ed25519_check_x_is_0_and_X0_is_1:CMPI      ,R1,3
0x836c:                BRZ       839c
0x8370:                MOVI      R3,0
0x8374:                SUBP      R3,R3,R0
0x8378:                ANDI      R1,R0,1
0x837c:                CMP       ,R1,R22
0x8380:                BRZ       838c
0x8384:                MOV       R11,R0
0x8388:                JMP       8394
0x838c: point_decompress_ed25519_x_is_p_minus_x:MOV       R11,R3
0x8390:                JMP       8394
0x8394: point_decompress_ed25519_success:MOVI      R1,0
0x8398:                RET       
0x839c: point_decompress_ed25519_fail:MOVI      R1,1
0x83a0:                RET       
0x83a4: point_add_ed25519:SUBP      R0,R8,R7
0x83a8:                SUBP      R1,R12,R11
0x83ac:                MUL25519  R0,R0,R1
0x83b0:                ADDP      R1,R8,R7
0x83b4:                ADDP      R2,R12,R11
0x83b8:                MUL25519  R1,R1,R2
0x83bc:                MUL25519  R2,R10,R14
0x83c0:                MUL25519  R2,R2,R6
0x83c4:                ADDP      R2,R2,R2
0x83c8:                MUL25519  R3,R9,R13
0x83cc:                ADDP      R3,R3,R3
0x83d0:                SUBP      R4,R1,R0
0x83d4:                ADDP      R0,R1,R0
0x83d8:                SUBP      R1,R3,R2
0x83dc:                ADDP      R2,R3,R2
0x83e0:                MUL25519  R11,R4,R1
0x83e4:                MUL25519  R14,R4,R0
0x83e8:                MUL25519  R12,R2,R0
0x83ec:                MUL25519  R13,R2,R1
0x83f0:                RET       
0x83f4: point_dub_ed25519:MUL25519  R0,R7,R7
0x83f8:                MUL25519  R1,R8,R8
0x83fc:                MUL25519  R2,R9,R9
0x8400:                ADDP      R2,R2,R2
0x8404:                ADDP      R3,R0,R1
0x8408:                ADDP      R4,R7,R8
0x840c:                MUL25519  R4,R4,R4
0x8410:                SUBP      R4,R3,R4
0x8414:                SUBP      R0,R0,R1
0x8418:                ADDP      R1,R2,R0
0x841c:                MUL25519  R7,R4,R1
0x8420:                MUL25519  R9,R0,R1
0x8424:                MUL25519  R8,R0,R3
0x8428:                MUL25519  R10,R4,R3
0x842c:                RET       
0x8430: spm_ed25519_short:MOVI      R7,0
0x8434:                MOVI      R8,1
0x8438:                MOVI      R9,1
0x843c:                MOVI      R10,0
0x8440:                MOVI      R30,256
0x8444: spm_ed25519_short_loop:ROL       R28,R28
0x8448:                CSWAP     R7,R11
0x844c:                CSWAP     R8,R12
0x8450:                CSWAP     R9,R13
0x8454:                CSWAP     R10,R14
0x8458:                CALL      83a4
0x845c:                CALL      83f4
0x8460:                CSWAP     R7,R11
0x8464:                CSWAP     R8,R12
0x8468:                CSWAP     R9,R13
0x846c:                CSWAP     R10,R14
0x8470:                SUBI      R30,R30,1
0x8474:                BRNZ      8444
0x8478:                RET       
0x847c: hash_to_field_p25519:CALL      8644
0x8480:                MOVI      R0,1537
0x8484:                ROR       R0,R0
0x8488:                HASH_IT   
0x848c:                HASH      R0,R0
0x8490:                REDP      R0,R1,R0
0x8494:                RET       
0x8498: map_to_curve_elligator2_curve25519:MUL25519  R6,R0,R0
0x849c:                ADDP      R6,R6,R6
0x84a0:                MOVI      R30,1
0x84a4:                ADDP      R7,R6,R30
0x84a8:                CMPA      ,R7,0
0x84ac:                BRZ       85d0
0x84b0:                LD        R8,12768
0x84b4:                MOVI      R30,0
0x84b8:                SUBP      R9,R30,R8
0x84bc:                MUL25519  R8,R8,R6
0x84c0:                MUL25519  R10,R7,R7
0x84c4:                MUL25519  R11,R10,R7
0x84c8:                MUL25519  R8,R8,R9
0x84cc:                ADDP      R8,R8,R10
0x84d0:                MUL25519  R8,R8,R9
0x84d4:                MUL25519  R12,R11,R11
0x84d8:                MUL25519  R10,R12,R12
0x84dc:                MUL25519  R12,R12,R11
0x84e0:                MUL25519  R12,R12,R8
0x84e4:                MUL25519  R10,R10,R12
0x84e8:                MOV       R1,R10
0x84ec:                CALL      818c
0x84f0:                MUL25519  R2,R2,R2
0x84f4:                MUL25519  R2,R2,R2
0x84f8:                MUL25519  R13,R2,R10
0x84fc:                MUL25519  R13,R13,R12
0x8500:                LD        R30,12800
0x8504:                MUL25519  R14,R13,R30
0x8508:                MUL25519  R10,R13,R13
0x850c:                MUL25519  R10,R10,R11
0x8510:                SUBP      R4,R10,R8
0x8514:                CMPA      ,R4,0
0x8518:                BRNZ      8524
0x851c: curve25519_point_generate_y1_y11:MOV       R1,R13
0x8520:                JMP       852c
0x8524: curve25519_point_generate_y1_y12:MOV       R1,R14
0x8528:                JMP       852c
0x852c: curve25519_point_generate_y1_next:MUL25519  R2,R9,R6
0x8530:                MUL25519  R3,R13,R0
0x8534:                ORI       R4,R30,1
0x8538:                MUL25519  R3,R3,R4
0x853c:                MUL25519  R4,R3,R30
0x8540:                MUL25519  R6,R8,R6
0x8544:                MUL25519  R10,R3,R3
0x8548:                MUL25519  R10,R10,R11
0x854c:                SUBP      R30,R10,R6
0x8550:                CMPA      ,R30,0
0x8554:                BRNZ      8560
0x8558: curve25519_point_generate_y2_y21:MOV       R0,R3
0x855c:                JMP       8568
0x8560: curve25519_point_generate_y2_y22:MOV       R0,R4
0x8564:                JMP       8568
0x8568: curve25519_point_generate_y2_next:MUL25519  R10,R1,R1
0x856c:                MUL25519  R10,R10,R11
0x8570:                SUBP      R30,R10,R8
0x8574:                CMPA      ,R30,0
0x8578:                BRNZ      8584
0x857c: curve25519_point_generate_xn_x1n:MOV       R3,R9
0x8580:                JMP       858c
0x8584: curve25519_point_generate_xn_x2n:MOV       R3,R2
0x8588:                JMP       858c
0x858c: curve25519_point_generate_xn_next:BRNZ      859c
0x8590: curve25519_point_generate_y_y1:MOV       R2,R1
0x8594:                MOVI      R30,1
0x8598:                JMP       85a8
0x859c: curve25519_point_generate_y_y2:MOV       R2,R0
0x85a0:                MOVI      R30,0
0x85a4:                JMP       85a8
0x85a8: curve25519_point_generate_y_next:MOVI      R0,0
0x85ac:                SUBP      R1,R0,R2
0x85b0:                MOVI      R8,1
0x85b4:                AND       R6,R2,R8
0x85b8:                XOR       R30,R30,R6
0x85bc:                BRZ       85c8
0x85c0: curve25519_point_generate_y_minus:MOV       R11,R1
0x85c4:                JMP       85d0
0x85c8: curve25519_point_generate_y_plus:MOV       R11,R2
0x85cc:                JMP       85d0
0x85d0: curve25519_point_generate_y_final:RET       
0x85d4: curve25519_point_generate:LD        R31,12480
0x85d8:                GRV       R2
0x85dc:                CALL      847c
0x85e0:                CALL      8498
0x85e4:                CMPA      ,R7,0
0x85e8:                BRZ       85d4
0x85ec:                MOV       R10,R3
0x85f0:                MOV       R12,R7
0x85f4:                MUL25519  R11,R11,R12
0x85f8:                RET       
0x85fc: ed25519_point_generate:LD        R31,12480
0x8600:                GRV       R2
0x8604:                CALL      847c
0x8608:                CALL      8498
0x860c:                CMPA      ,R7,0
0x8610:                BRZ       85fc
0x8614:                LD        R30,12832
0x8618:                MUL25519  R10,R3,R30
0x861c:                MUL25519  R12,R7,R11
0x8620:                SUBP      R11,R3,R7
0x8624:                ADDP      R13,R3,R7
0x8628:                MUL25519  R0,R12,R13
0x862c:                CMPA      ,R0,0
0x8630:                BRZ       85fc
0x8634:                MUL25519  R10,R10,R13
0x8638:                MUL25519  R11,R11,R12
0x863c:                MOV       R12,R0
0x8640:                RET       
0x8644: compose_exp_tag:MOVI      R3,84
0x8648:                ROL8      R3,R3
0x864c:                ORI       R3,R3,83
0x8650:                ROL8      R3,R3
0x8654:                ORI       R3,R3,1
0x8658:                ROL8      R3,R3
0x865c:                ORI       R3,R3,128
0x8660:                ROR8      R3,R3
0x8664:                RET       
0x8668: eddsa_verify:  LD        R28,64
0x866c:                LD        R31,12480
0x8670:                LD        R6,12576
0x8674:                LD        R11,12608
0x8678:                LD        R12,12640
0x867c:                MOVI      R13,1
0x8680:                MUL25519  R14,R11,R12
0x8684:                CALL      8430
0x8688:                ST        R7,256
0x868c:                ST        R8,288
0x8690:                ST        R9,320
0x8694:                ST        R10,352
0x8698: bp_eddsa_verify_sxb:LD        R24,160
0x869c:                LD        R25,128
0x86a0:                LD        R26,96
0x86a4:                LD        R27,32
0x86a8:                SWE       R20,R24
0x86ac:                SWE       R21,R25
0x86b0:                SWE       R22,R26
0x86b4:                SWE       R23,R27
0x86b8:                HASH_IT   
0x86bc:                HASH      R28,R20
0x86c0:                MOVI      R3,128
0x86c4:                ROR8      R3,R3
0x86c8:                MOVI      R2,0
0x86cc:                MOVI      R1,0
0x86d0:                MOVI      R0,1024
0x86d4:                HASH      R28,R0
0x86d8:                SWE       R28,R28
0x86dc:                SWE       R29,R29
0x86e0: bp_eddsa_verify_after_hram:LD        R31,12512
0x86e4:                REDP      R28,R28,R29
0x86e8:                LD        R31,12480
0x86ec:                MOV       R12,R26
0x86f0:                CALL      82a0
0x86f4: bp_eddsa_verify_deca:CMPI      ,R1,0
0x86f8:                BRNZ      8748
0x86fc:                MOVI      R13,1
0x8700:                MUL25519  R14,R11,R12
0x8704:                CALL      8430
0x8708: bp_eddsa_verify_exa:MOVI      R0,0
0x870c:                SUBP      R7,R0,R7
0x8710:                SUBP      R10,R0,R10
0x8714:                LD        R11,256
0x8718:                LD        R12,288
0x871c:                LD        R13,320
0x8720:                LD        R14,352
0x8724:                CALL      83a4
0x8728:                MOV       R7,R11
0x872c:                MOV       R8,R12
0x8730:                MOV       R9,R13
0x8734:                CALL      8278
0x8738: bp_eddsa_verify_encq:LD        R31,12736
0x873c:                SUBP      R0,R27,R8
0x8740:                CMPA      ,R0,0
0x8744:                BRZ       8754
0x8748: eddsa_verify_fail:MOVI      R0,0
0x874c:                ST        R0,4128
0x8750:                END       
0x8754: eddsa_verify_success:MOVI      R0,1
0x8758:                ST        R0,4128
0x875c:                END       
0x8760: sha512_one_block:SWE       R3,R3
0x8764:                SWE       R2,R2
0x8768:                SWE       R1,R1
0x876c:                SWE       R0,R0
0x8770:                HASH      R4,R0
0x8774:                RET       
0x8778: sha512_init:   HASH_IT   
0x877c:                MOVI      R0,0
0x8780:                ST        R0,4096
0x8784:                END       
0x8788: sha512_update: LD        R3,32
0x878c:                LD        R2,64
0x8790:                LD        R1,96
0x8794:                LD        R0,128
0x8798:                CALL      8760
0x879c:                MOVI      R0,0
0x87a0:                ST        R0,4096
0x87a4:                END       
0x87a8: sha512_final:  LD        R3,32
0x87ac:                LD        R2,64
0x87b0:                LD        R1,96
0x87b4:                LD        R0,128
0x87b8:                CALL      8760
0x87bc:                SWE       R4,R4
0x87c0:                SWE       R5,R5
0x87c4:                ST        R5,4128
0x87c8:                ST        R4,4160
0x87cc:                HASH_IT   
0x87d0:                MOVI      R0,0
0x87d4:                ST        R0,4096
0x87d8:                END       
